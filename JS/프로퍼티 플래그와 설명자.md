# 프로퍼티 플래그와 설명자

- 아시다시피 객체엔 프로퍼티가 저장됩니다.
- 지금까진 프로퍼티를 단순히 `‘키-값’` 쌍의 관점에서만 다뤘습니다.
- 그런데 사실 프로퍼티는 우리가 생각했던 것보다 `더 유연하고 강력한 자료구조`입니다.
- 이 챕터에선 객체 프로퍼티 추가 구성 옵션 몇 가지를 다루고, 이어지는 챕터에선 이 옵션들을 이용해 손쉽게 `getter`나 `setter` 함수를 만드는 법을 알아보겠습니다.

<br>

## 프로퍼티 플래그

- 객체 프로퍼티는 `값(value)` 과 함께 `플래그(flag)`라 불리는 특별한 속성 세 가지를 갖습니다.
- `writable` : `true`이면 값을 수정할 수 있습니다. 그렇지 않다면 읽기만 가능합니다.
- `enumerable` : `true`이면 `반복문`을 사용해 나열할 수 있습니다. 그렇지 않다면 반복문을 사용해 나열할 수 없습니다.
- `configurable` : `true`이면 `프로퍼티 삭제`나 `플래그 수정`이 가능합니다. 그렇지 않다면 프로퍼티 삭제와 플래그 수정이 불가능합니

<br>

- 프로퍼티 플래그는 특별한 경우가 아니고선 다룰 일이 없기 때문에 여기서 처음 소개하게 되었습니다.
- 지금까지 해왔던 `'평범한 방식’`으로 프로퍼티를 만들면 해당 프로퍼티의 플래그는 모두 `true`가 됩니다.
- 이렇게 `true`로 설정된 플래그는 언제든 수정할 수 있습니다.
- 자 이제 본격적으로 `프로퍼티 플래그`에 대해 다뤄봅시다.
- 먼저 `플래그`를 얻는 방법을 알아보겠습니다.
- `Object.getOwnPropertyDescriptor` 메서드를 사용하면 특정 프로퍼티에 대한 정보를 모두 얻을 수 있습니다.

<br>

- 문법

```js
let descriptor = Object.getOwnPropertyDescriptor(obj, propertyName);
```

- `obj` : 정보를 얻고자 하는 객체
- `propertyName` : 정보를 얻고자 하는 객체 내 프로퍼티
- 메서드를 호출하면 `"프로퍼티 설명자(descriptor)"`라고 불리는 객체가 반환되는데, 여기에는 프로퍼티 값과 세 플래그에 대한 정보가 모두 담겨있습니다.
- 예시

```js
let user = {
  name: "John",
};

let descriptor = Object.getOwnPropertyDescriptor(user, "name");

alert(JSON.stringify(descriptor, null, 2));
/* property descriptor:
{
  "value": "John",
  "writable": true,
  "enumerable": true,
  "configurable": true
}
*/
```

<br>

- 메서드 `Object.defineProperty`를 사용하면 플래그를 변경할 수 있습니다.
- 문법

```js
Object.defineProperty(obj, propertyName, descriptor);
```

- `obj`, `propertyName` : 설명자를 적용하고 싶은 객체와 객체 프로퍼티
- `descriptor` : 적용하고자 하는 프로퍼티 설명자
- `defineProperty`메서드는 객체에 해당 프로퍼티가 있으면 플래그를 원하는 대로 변경해줍니다.
- 프로퍼티가 없으면 인수로 넘겨받은 정보를 이용해 새로운 프로퍼티를 만듭니다.
- 이때 플래그 정보가 없으면 플래그 값은 자동으로 `false`가 됩니다.
- 아래 예시를 보면 프로퍼티 `name`이 새로 만들어지고, 모든 플래그 값이 `false`가 된 것을 확인할 수 있습니다.

```js
let user = {};

Object.defineProperty(user, "name", {
  value: "John",
});

let descriptor = Object.getOwnPropertyDescriptor(user, "name");

alert(JSON.stringify(descriptor, null, 2));
/*
{
  "value": "John",
  "writable": false,
  "enumerable": false,
  "configurable": false
}
 */
```

- ‘평범한 방식으로’ 객체 프로퍼티 `user.name`을 만들었을 때와 `defineProperty`를 이용해 프로퍼티를 만들었을 때의 가장 큰 차이점은 플래그에 있습니다.
- `defineProperty`를 사용해 프로퍼티를 만든 경우, `descriptor`에 플래그 값을 명시하지 않으면 플래그 값이 자동으로 `false`가 됩니다. - 플래그 값을 `true`로 설정하려면 `descriptor`에 `true`라고 명시해 주어야 합니다.
- 이제 예시를 통해 플래그의 효과에 대해 알아봅시다.

<br>

## writable 플래그

- `writable` 플래그를 사용해 `user.name`에 값을 쓰지 못하도록(non-writable) 해봅시다.

```js
let user = {
  name: "John",
};

Object.defineProperty(user, "name", {
  writable: false,
});

user.name = "Pete"; // Error: Cannot assign to read only property 'name'
```

- 이제 `defineProperty`를 사용해 `writable` 플래그를 `true`로 변경하지 않는 한 그 누구도 객체의 이름을 변경할 수 없게 되었습니다.

<br>

### 에러는 엄격 모드에서만 발생합니다.

- 비 엄격 모드에선 읽기 전용 프로퍼티에 값을 쓰려고 해도 에러가 발생하지 않습니다.
- 다만 이때 값을 변경하는 것은 불가능합니다.
- 비 엄격 모드에선 이와 같이 플래그에서 정한 규칙을 위반하는 행위는 에러 없이 그냥 무시됩니다.

<br>

- 아래 예시는 위 예시와 동일하게 동작합니다.
- 다만 아래 예시에선 `defineProperty` 메서드를 사용해 프로퍼티를 밑바닥부터 만들어 보았습니다.

```js
let user = {};

Object.defineProperty(user, "name", {
  value: "John",
  // defineProperty를 사용해 새로운 프로퍼티를 만들 땐, 어떤 플래그를 true로 할지 명시해주어야 합니다.
  enumerable: true,
  configurable: true,
});

alert(user.name); // John
user.name = "Pete"; // Error
```

<br>

## enumerable 플래그

[출처]
https://ko.javascript.info/property-descriptors
